{
    "_comment": "Global Layout Configuration v2. Safe-area 기반 반응형 레이아웃. (이 파일 수정 후 재시작/리로드 시 UI 반영)",
    "version": 2,
    "debug": {
        "showGrid": true,
        "showSafeArea": true,
        "showElementBounds": true,
        "_comment_player": "플레이어 손패 슬롯/정렬 디버그 시각화",
        "player": {
            "handSlotGrid": true,
            "sortedOrderOverlay": true
        }
    },
    "_units": {
        "_desc": "ratio: 0..1 (컨테이너 정규화 좌표/비율). pt: referenceCanvas 기준 포인트(전역 스케일 적용). spacing/overlap ratio는 cardWidth 기준.",
        "_desc_slots": "fixedSlots: 슬롯은 항상 고정된 좌표를 가지며, occupied=false가 되어도 슬롯 좌표는 변하지 않음(preserveOnRemove=true)."
    },
    "referenceCanvas": {
        "_desc": "전역 스케일 계산용 기준 캔버스(포인트). iPhone 계열의 대표값으로 설정.",
        "widthPt": 390,
        "heightPt": 844
    },
    "scaling": {
        "_desc": "globalScale = clamp(min(safeW/refW, safeH/refH), min, max). pt 단위 값에 곱해짐.",
        "min": 0.65,
        "max": 1.20
    },
    "tokens": {
        "_desc": "pt 값들은 globalScale이 곱해져 기기별로 자동 조정됨.",
        "outerInsetPt": 16,
        "areaGapPt": 8,
        "panelPaddingPt": 10,
        "panelCornerRadiusPt": 18,
        "safeAreaTopPaddingPt": 44,
        "safeAreaBottomPaddingPt": 22
    },
    "card": {
        "_desc": "카드 기준 크기. baseWidthRatio는 safeW 대비 비율(1차값)이며, 최종 폭은 코드에서 hand-fit 조건으로 추가 조정 권장.",
        "baseWidthRatio": 0.155,
        "minWidthPt": 34,
        "maxWidthPt": 70,
        "aspectRatio": 1.6,
        "_descCorner": "cornerRadiusRatio는 (cornerRadius = cardWidth * ratio).",
        "cornerRadiusRatio": 0.12,
        "shadow": {
            "_desc": "pt 기반: globalScale 곱 적용.",
            "radiusPt": 2.0,
            "yOffsetPt": 1.0,
            "opacity": 0.25
        },
        "backColor": "#CC3333",
        "backCircleColor": "#991A1A",
        "_comment_clamp": "손패 10슬롯이 겹치지 않게 cardWidth를 clamp하는 규칙(권장). 구현에서 적용.",
        "clampRules": {
            "playerHandFixedSlots": {
                "slotOverlapAllowed": false,
                "slotMinGapRatio": 0.08
            }
        }
    },
    "images": {
        "prefix": "Card_"
    },
    "areas": {
        "_desc": "Opponent / Center / Player 3영역. heightRatio 합이 1.0이 되도록 구성. 각 영역은 ratio 기반 + min/max(권장)로 안정화.",
        "opponent": {
            "heightRatio": 0.1,
            "minHeightPt": 50,
            "maxHeightPt": 180,
            "flexWeight": 1,
            "background": {
                "color": "#F1F8E9",
                "opacity": 0.40,
                "cornerRadiusPt": 0,
                "widthRatio": 1.0
            },
            "elements": {
                "hand": {
                    "_desc": "상대 손패(보통 10장). 겹침으로 ‘크기는 키우고 폭은 줄이기’.",
                    "x": 0.5,
                    "y": 0.25,
                    "scale": 0.2,
                    "zIndex": 10,
                    "grid": {
                        "rows": 1,
                        "maxCols": 10,
                        "_descSpacing": "cardWidth 기준 비율",
                        "hSpacingCardRatio": 0.04,
                        "_descOverlap": "0.62 = 62% 겹침 (다음 카드의 이동량은 (1-overlap)*cardWidth로 계산)",
                        "overlapRatio": 0.62
                    }
                },
                "captured": {
                    "_desc": "상대 획득패",
                    "x": 0.5,
                    "y": 0.60,
                    "scale": 0.45,
                    "zIndex": 5,
                    "layout": {
                        "groupSpacingCardRatio": 0.26,
                        "cardOverlapRatio": 0.62
                    }
                }
            }
        },
        "center": {
            "heightRatio": 0.4,
            "minHeightPt": 210,
            "maxHeightPt": 380,
            "flexWeight": 2,
            "background": {
                "color": "#62c522",
                "opacity": 0.60,
                "cornerRadiusPt": 18,
                "widthRatio": 1.0
            },
            "elements": {
                "table": {
                    "_desc": "바닥 패(12 Fixed Slots). Deck 중심 좌우 6개씩 배치.",
                    "x": 0.5,
                    "y": 0.5,
                    "scale": 0.70,
                    "zIndex": 1,
                    "mode": "fixedSlots12",
                    "grid": {
                        "rows": 2,
                        "cols": 8,
                        "vSpacingCardRatio": 0.10,
                        "hSpacingCardRatio": 0.12,
                        "_desc": "Legacy grid properties kept for fallback",
                        "stackOverlapRatio": 0.80,
                        "stackDirection": "diagonal"
                    },
                    "fixedSlots": {
                        "fillPolicy": "centerOutwards",
                        "slots": [
                            {
                                "slotIndex": 1,
                                "anchorX": 0.20,
                                "anchorY": 0.20,
                                "preserveOnRemove": true
                            },
                            {
                                "slotIndex": 2,
                                "anchorX": 0.40,
                                "anchorY": 0.20,
                                "preserveOnRemove": true
                            },
                            {
                                "slotIndex": 3,
                                "anchorX": 0.60,
                                "anchorY": 0.20,
                                "preserveOnRemove": true
                            },
                            {
                                "slotIndex": 4,
                                "anchorX": 0.80,
                                "anchorY": 0.20,
                                "preserveOnRemove": true
                            },
                            {
                                "slotIndex": 5,
                                "anchorX": 0.10,
                                "anchorY": 0.50,
                                "preserveOnRemove": true
                            },
                            {
                                "slotIndex": 6,
                                "anchorX": 0.30,
                                "anchorY": 0.50,
                                "preserveOnRemove": true
                            },
                            {
                                "slotIndex": 7,
                                "anchorX": 0.70,
                                "anchorY": 0.50,
                                "preserveOnRemove": true
                            },
                            {
                                "slotIndex": 8,
                                "anchorX": 0.90,
                                "anchorY": 0.50,
                                "preserveOnRemove": true
                            },
                            {
                                "slotIndex": 9,
                                "anchorX": 0.20,
                                "anchorY": 0.80,
                                "preserveOnRemove": true
                            },
                            {
                                "slotIndex": 10,
                                "anchorX": 0.40,
                                "anchorY": 0.80,
                                "preserveOnRemove": true
                            },
                            {
                                "slotIndex": 11,
                                "anchorX": 0.60,
                                "anchorY": 0.80,
                                "preserveOnRemove": true
                            },
                            {
                                "slotIndex": 12,
                                "anchorX": 0.80,
                                "anchorY": 0.80,
                                "preserveOnRemove": true
                            }
                        ]
                    }
                },
                "deck": {
                    "_desc": "덱(중앙)",
                    "x": 0.5,
                    "y": 0.5,
                    "scale": 0.7,
                    "zIndex": 50
                }
            }
        },
        "player": {
            "heightRatio": 0.45,
            "minHeightPt": 240,
            "maxHeightPt": 520,
            "flexWeight": 2,
            "background": {
                "color": "#F1F8E9",
                "opacity": 0.40,
                "cornerRadiusPt": 0,
                "widthRatio": 1.0
            },
            "elements": {
                "captured": {
                    "_desc": "플레이어 획득패",
                    "x": 0.5,
                    "y": 0.18,
                    "scale": 0.5,
                    "zIndex": 5,
                    "layout": {
                        "groupSpacingCardRatio": 0.26,
                        "cardOverlapRatio": 0.62
                    }
                },
                "hand": {
                    "_desc": "플레이어 손패(최대 10장). 10개 슬롯 고정 + 정렬 시 슬롯 간 이동만 허용 + 카드 사용 후 빈 슬롯 공간 유지.",
                    "x": 0.5,
                    "y": 0.60,
                    "scale": 0.9,
                    "zIndex": 20,
                    "_comment_mode": "grid는 배경/간격 기준값으로 유지하되, 배치는 fixedSlots10 모드가 슬롯 좌표를 소스 오브 트루스로 사용.",
                    "mode": "fixedSlots10",
                    "grid": {
                        "rows": 2,
                        "maxCols": 5,
                        "vSpacingCardRatio": 0.08,
                        "hSpacingCardRatio": 0.10,
                        "background": {
                            "color": "#FFFFFF",
                            "opacity": 0.10,
                            "cornerRadiusPt": 16,
                            "widthRatio": 0.94,
                            "paddingPt": 5
                        }
                    },
                    "sorting": {
                        "_comment": "정렬 규칙: 월(1..12) → 등급/타입([광,동물,리본,피]) → 동일 월/타입은 드로우 순서 유지(stable).",
                        "enabled": true,
                        "primaryKey": "month",
                        "secondaryKey": "type",
                        "typeOrder": [
                            "gwang",
                            "animal",
                            "ribbon",
                            "pi"
                        ],
                        "stableTieBreak": "drawOrder",
                        "_comment_indices": "디버그/애니메이션을 위해 정렬 인덱스 매핑을 생성하도록 요청",
                        "produceSortedIndicesMapping": true,
                        "sortedIndicesKey": "sortedIndices"
                    },
                    "slotPlacementPolicy": {
                        "_comment": "핵심: 슬롯은 10개 고정. 카드 사용 후 빈 슬롯 이동(Compaction).",
                        "preserveEmptySlots": false,
                        "preserveSlotCoordinates": true,
                        "assignmentOnSort": "reassignWithinOccupiedSlots",
                        "occupiedSlotSequence": [
                            1,
                            2,
                            3,
                            4,
                            5,
                            6,
                            7,
                            8,
                            9,
                            10
                        ],
                        "_comment_draw": "새 카드(드로우)로 hand에 추가될 때 빈 슬롯을 채우는 규칙(권장: 앞에서부터 첫 빈 슬롯)",
                        "fillOnDraw": "firstEmptyFromStart"
                    },
                    "slotConstraints": {
                        "slotOverlapAllowed": false,
                        "slotMinGapRatio": 0.08
                    },
                    "fixedSlots": {
                        "_comment": "슬롯 좌표는 hand 컨테이너(배경 패널) 내부 정규화 좌표로 해석(0..1). occupied=false여도 슬롯은 남음.",
                        "count": 10,
                        "slotIndexing": "rowMajorLeading",
                        "slots": [
                            {
                                "slotIndex": 1,
                                "row": 0,
                                "col": 0,
                                "anchorX": 0.10,
                                "anchorY": 0.25,
                                "maxCardScale": 1.0,
                                "occupied": false,
                                "preserveOnRemove": true
                            },
                            {
                                "slotIndex": 2,
                                "row": 0,
                                "col": 1,
                                "anchorX": 0.30,
                                "anchorY": 0.25,
                                "maxCardScale": 1.0,
                                "occupied": false,
                                "preserveOnRemove": true
                            },
                            {
                                "slotIndex": 3,
                                "row": 0,
                                "col": 2,
                                "anchorX": 0.50,
                                "anchorY": 0.25,
                                "maxCardScale": 1.0,
                                "occupied": false,
                                "preserveOnRemove": true
                            },
                            {
                                "slotIndex": 4,
                                "row": 0,
                                "col": 3,
                                "anchorX": 0.70,
                                "anchorY": 0.25,
                                "maxCardScale": 1.0,
                                "occupied": false,
                                "preserveOnRemove": true
                            },
                            {
                                "slotIndex": 5,
                                "row": 0,
                                "col": 4,
                                "anchorX": 0.90,
                                "anchorY": 0.25,
                                "maxCardScale": 1.0,
                                "occupied": false,
                                "preserveOnRemove": true
                            },
                            {
                                "slotIndex": 6,
                                "row": 1,
                                "col": 0,
                                "anchorX": 0.10,
                                "anchorY": 0.75,
                                "maxCardScale": 1.0,
                                "occupied": false,
                                "preserveOnRemove": true
                            },
                            {
                                "slotIndex": 7,
                                "row": 1,
                                "col": 1,
                                "anchorX": 0.30,
                                "anchorY": 0.75,
                                "maxCardScale": 1.0,
                                "occupied": false,
                                "preserveOnRemove": true
                            },
                            {
                                "slotIndex": 8,
                                "row": 1,
                                "col": 2,
                                "anchorX": 0.50,
                                "anchorY": 0.75,
                                "maxCardScale": 1.0,
                                "occupied": false,
                                "preserveOnRemove": true
                            },
                            {
                                "slotIndex": 9,
                                "row": 1,
                                "col": 3,
                                "anchorX": 0.70,
                                "anchorY": 0.75,
                                "maxCardScale": 1.0,
                                "occupied": false,
                                "preserveOnRemove": true
                            },
                            {
                                "slotIndex": 10,
                                "row": 1,
                                "col": 4,
                                "anchorX": 0.90,
                                "anchorY": 0.75,
                                "maxCardScale": 1.0,
                                "occupied": false,
                                "preserveOnRemove": true
                            }
                        ]
                    }
                }
            }
        }
    }
}